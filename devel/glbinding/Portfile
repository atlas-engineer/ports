# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem              1.0
PortGroup               cmake 1.0
PortGroup               cxx11 1.0
PortGroup               github 1.0

github.setup            cginternals glbinding 2.1.1 v
categories              devel
platforms               darwin
maintainers             nomaintainer
license                 MIT

description             glbinding is a cross-platform C++ binding for OpenGL
long_description        glbinding leverages modern C++11 features like enum classes, lambdas, and \
                        variadic templates, instead of relying on macros. All OpenGL symbols are \
                        real functions and variables. It provides type-safe parameters, per feature \
                        API header, lazy function resolution, multi-context and multi-thread support, \
                        global and local function callbacks, meta information about the generated OpenGL \
                        binding and the OpenGL runtime, as well as tools and examples for quick-starting \
                        your projects. Based on the OpenGL API specification (gl.xml) glbinding is \
                        generated using python scripts and templates that can be easily adapted to fit custom needs.

checksums               rmd160  1c95c08d50d0e14c890d890fbfb1d0c612c16562 \
                        sha256  2ce7d20d92703a855ce2ccf1f349d6721c0d9d8aab9da42aa303f0831290f77c
    
# prevent failed builds on incompatible systems
#pre-fetch {
#    if {${os.platform} eq "darwin" && ${os.major} < 13} {
#        ui_error "Presently requires 10.9 or later (requires Thread-Local Storage)"
#        return -code error "incompatible Mac operating system version"
#    }
#}

depends_build-append    port:py27-pystache \
                        port:glfw
configure.args-append   -DPYTHON_EXECUTABLE:FILEPATH=${prefix}/bin/python2.7

cmake.out_of_source     yes

# patch to override folder layout logic to match macports
patchfiles-append       001-patch-glbinding-cmake-installdirs.diff
patchfiles-append       002-patch-glbinding-cmake-files-dir.diff

# patch to make qt example a separate option
patchfiles-append       003-patch-glbinding-src-examples-cmakelists-optionglexamples.diff

variant docs description "install documentation" {
    configure.args-append   -DOPTION_BUILD_DOCS:BOOL=ON
    depends_build-append    port:doxygen
}

variant examples description "install examples without qt5 example" {
    configure.args-append   -DOPTION_BUILD_EXAMPLES:BOOL=ON
    depends_run-append      port:glew \
    						port:cpplocate
}

variant qtexamples description "install examples including qt5 example" {
    configure.args-append   -DOPTION_BUILD_EXAMPLES:BOOL=ON
    configure.args-append   -DOPTION_BUILD_QT_EXAMPLES:BOOL=ON
    depends_run-append      port:glew \
                            port:cpplocate \
                            port:qt5
}
