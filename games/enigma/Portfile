# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem              1.0

name                    enigma
version                 1.21
categories              games
platforms               darwin
maintainers             {kencu @kencu} openmaintainer
license                 GPL-2+
homepage                https://www.nongnu.org/enigma/

master_sites            sourceforge:project/enigma-game/Release%20${version}/

description             puzzle game inspired by the games Oxyd and Rock'n'Roll
    
long_description        Enigma is a puzzle game inspired by Oxyd on the Atari ST and Rock'n'Roll \
                        on the Amiga. The object of the game is to find and uncover pairs of \
                        identically colored Oxyd stones. Simple? Yes. Easy? Certainly not! Hidden \
                        traps, vast mazes, laser beams, and, most of all, countless hairy puzzles \
                        usually block your direct way to the Oxyd stones.

checksums               rmd160  7942dd2acc1e21cb40200a9ae767a4673c569a2a \
                        sha256  d872cf067d8eb560d3bb1cb17245814bc56ac3953ae1f12e2229c8eb6f82ce01

use_parallel_build      no
use_autoconf            yes

configure.args-append   --with-libintl-prefix=${prefix}
configure.cppflags-prepend \
                        -I${prefix}/include/lua-5.1

#configure.ldflags-append -licuuc -liconv

# remove SDL frameworks - these are not used in MacPorts
patchfiles-append       patch-configure-ac-remove-frameworks.diff
patchfiles-append       patch-src-makefile-in-remove-frameworks.diff

# fix library links
patchfiles-append       patch-configure-ac-fix-libiconv-libicuuc.diff

depends_build-append    port:pkgconfig \
                        port:ImageMagick \
                        port:texi2html \
                        port:osxutils

depends_lib             port:libsdl \
                        port:libsdl_image \
                        port:libsdl_mixer \
                        port:libsdl_ttf \
                        port:freetype \
                        port:gettext \
                        port:jpeg \
                        port:libpng \
                        port:xercesc3 \
                        port:curl \
                        port:zlib \
                        port:bzip2 \
                        port:lua51 \
                        port:libiconv \
                        port:icu

build.target            all macapp

destroot {
    copy ${worksrcpath}/etc/macfiles/Enigma.app \
        ${destroot}${applications_dir}/
}

livecheck.type          sourceforge
livecheck.regex         /${name}-(\[0-9\]+\\.\[0-9\]*\[02468\](\\.\[0-9\]+)*)${extract.suffix}
